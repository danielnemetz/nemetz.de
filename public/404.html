<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="404 - Page not found">

        <title>404 - Page not found &middot; nemetz.de</title>

        <!-- Favicons -->
        <link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicons/favicon.svg" />
        <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
        <link rel="manifest" href="/favicons/site.webmanifest" />
        <link rel="icon" href="/favicons/favicon.ico" sizes="any" />

        <!-- Styles -->
        <style>
            *,
            *::before,
            *::after {
                margin: 0;
                padding: 0;
            }
            html,
            body {
                font-family: 'Roboto Slab', serif;
                font-weight: 300;
                color: #d62222;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            body {
                display: flex;
                flex-direction: column;
                background-color: black;
                overflow: hidden;
            }
            main {
                display: flex;
                flex-direction: column;
                flex-grow: 1;
                justify-content: flex-end;
                align-items: flex-end;
                padding: 0;
                margin: 0;
                overflow: hidden;
                position: relative;
            }
            .error-404 {
                width: 50vh;
                height: 25vh;
                opacity: 0.5;
                position: absolute;
                left: 0;
                top: 0;
                will-change: transform;
            }
            
            .error-404 object {
                width: 100%;
                height: 100%;
                pointer-events: none;
            }
        </style>
    </head>
    <body>
        <main>
            <div class="error-404">
                <object data="/404-logo.svg" type="image/svg+xml" id="svg-logo"></object>
            </div>
        </main>
        <script>
            (function() {
                const element = document.querySelector('.error-404');
                const svgObject = document.querySelector('#svg-logo');
                
                // Adjust ellipse width to match 404 text width and crop SVG when SVG loads
                function adjustEllipseWidth() {
                    svgObject.addEventListener('load', function() {
                        const svgDoc = svgObject.contentDocument;
                        if (svgDoc) {
                            const svg = svgDoc.documentElement;
                            const logo404 = svgDoc.querySelector('#logo-404');
                            const ellipse = svgDoc.querySelector('#ellipse');
                            const ellipseMask = svgDoc.querySelector('#ellipse-mask-shape');
                            
                            if (logo404 && ellipse && ellipseMask) {
                                const textBBox = logo404.getBBox();
                                const textWidth = textBBox.width;
                                // Set ellipse width to match 404 text width (rx is half-width)
                                const ellipseWidth = textWidth / 2;
                                ellipse.setAttribute('rx', ellipseWidth);
                                ellipseMask.setAttribute('rx', ellipseWidth);
                            }
                        }
                    });
                }
                
                const colors = [
                    '#ff0000', // Rot
                    '#ff8800', // Orange
                    '#ffff00', // Gelb
                    '#00ff00', // Gr√ºn
                    '#0000ff', // Blau
                    '#8800ff'  // Violett
                ];
                let colorIndex = Math.floor(Math.random() * colors.length);
                let x = 0;
                let y = 0;
                let dx = 2;
                let dy = 2;
                let animationId = null;
                let isPaused = false;
                
                // Cache dimensions to avoid repeated getBoundingClientRect calls
                let elementWidth = 0;
                let elementHeight = 0;
                let viewportWidth = 0;
                let viewportHeight = 0;
                
                function updateDimensions() {
                    const rect = element.getBoundingClientRect();
                    elementWidth = rect.width;
                    elementHeight = rect.height;
                    viewportWidth = window.innerWidth;
                    viewportHeight = window.innerHeight;
                }
                
                function changeColor() {
                    colorIndex = (colorIndex + 1) % colors.length;
                    const newColor = colors[colorIndex];
                    // Update SVG color
                    const svgDoc = svgObject.contentDocument;
                    if (svgDoc) {
                        const style = svgDoc.querySelector('style');
                        if (style) {
                            style.textContent = style.textContent.replace(/fill: (#[0-9a-fA-F]{6}|currentColor)/g, `fill: ${newColor}`);
                        }
                    }
                }
                
                function animate() {
                    if (isPaused) {
                        return;
                    }
                    
                    // Update position
                    x += dx;
                    y += dy;
                    
                    // Bounce with negative margins: -100px left/right, -50px top/bottom
                    const marginX = 100;
                    const marginY = 50;
                    
                    let bounced = false;
                    
                    // Calculate bounds without getBoundingClientRect
                    const left = x;
                    const right = x + elementWidth;
                    const top = y;
                    const bottom = y + elementHeight;
                    
                    if (left <= -marginX) {
                        dx = -dx;
                        x = -marginX;
                        bounced = true;
                    } else if (right >= viewportWidth + marginX) {
                        dx = -dx;
                        x = viewportWidth + marginX - elementWidth;
                        bounced = true;
                    }
                    
                    if (top <= -marginY) {
                        dy = -dy;
                        y = -marginY;
                        bounced = true;
                    } else if (bottom >= viewportHeight + marginY) {
                        dy = -dy;
                        y = viewportHeight + marginY - elementHeight;
                        bounced = true;
                    }
                    
                    if (bounced) {
                        changeColor();
                    }
                    
                    // Use transform instead of left/top for better performance (GPU accelerated)
                    element.style.transform = `translate(${x}px, ${y}px)`;
                    
                    animationId = requestAnimationFrame(animate);
                }
                
                // Pause animation when tab is not visible
                document.addEventListener('visibilitychange', function() {
                    if (document.hidden) {
                        isPaused = true;
                        if (animationId) {
                            cancelAnimationFrame(animationId);
                            animationId = null;
                        }
                    } else {
                        isPaused = false;
                        updateDimensions();
                        if (!animationId) {
                            animate();
                        }
                    }
                });
                
                // Update dimensions on resize
                window.addEventListener('resize', function() {
                    updateDimensions();
                });
                
                adjustEllipseWidth();
                
                // Wait for fonts to load to get accurate dimensions
                if (document.fonts && document.fonts.ready) {
                    document.fonts.ready.then(() => {
                        setTimeout(() => {
                            initializePosition();
                            animate();
                        }, 200);
                    });
                } else {
                    setTimeout(() => {
                        initializePosition();
                        animate();
                    }, 200);
                }
                
                function initializePosition() {
                    updateDimensions();
                    const marginX = 100;
                    const marginY = 50;
                    const maxX = viewportWidth + marginX * 2 - elementWidth;
                    const maxY = viewportHeight + marginY * 2 - elementHeight;
                    
                    // Random start position (accounting for negative margins)
                    x = Math.random() * maxX - marginX;
                    y = Math.random() * maxY - marginY;
                    
                    // Random direction (positive or negative) - constant speed like DVD screensaver
                    const speed = 3; // Constant speed similar to DVD screensaver
                    dx = (Math.random() > 0.5 ? 1 : -1) * speed;
                    dy = (Math.random() > 0.5 ? 1 : -1) * speed;
                    
                    // Set initial color (random)
                    const initialColor = colors[colorIndex];
                    const svgDoc = svgObject.contentDocument;
                    if (svgDoc) {
                        const style = svgDoc.querySelector('style');
                        if (style) {
                            style.textContent = style.textContent.replace(/fill: currentColor/g, `fill: ${initialColor}`);
                        }
                    }
                    
                    // Use transform instead of left/top
                    element.style.transform = `translate(${x}px, ${y}px)`;
                }
            })();
        </script>
    </body>
</html>

